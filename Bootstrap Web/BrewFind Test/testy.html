<HTML>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-3.3.0.js"></script>

<h1> HEY THIS IS A TEST PAGE!</h1>
<table>
	<thead><tr>
		<th>Brewery Name</th>
		<th>Email</th>
		<th>Phone</th>
	</tr></thead>
	<tbody data-bind="foreach: breweries">
		<tr>
			<td data-bind="text: name"></td>
			<td data-bind="text: email"></td>
			<td data-bind="text: phone"></td>
		</tr>
</table>
<script>

	function makeBrewery(name, email, phone) {
		var self = this;
		self.name = name;
		self.email = email;
		self.phone = phone;
	}
	
	var apiUrl = "http://localhost:8080/brewery";

	var breweries = ko.observableArray();
	
	$.ajax({
		type: "GET",
		url: apiUrl,
		dataType: "json",
		
		success: function(data) 
		{
			console.log("Got data!");
			console.log(data);
			rawBrews = data.rObj;
			rawBrews.forEach(function(entry) {
				console.log("Pushing " + entry.b_name);
				breweries.push(new makeBrewery(entry.b_name, entry.b_email, entry.b_phone));
			})
		},
		error: function(err)
		{
			console.log("Didn't get data...");
			console.log(err);
		}
	});
	
	ko.applyBindings(breweries);
	
</script>
</tbody>


</HTML>